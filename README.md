# ç‰©æµé…é€ç®¡ç†ç³»ç»Ÿ

åŸºäº NestJS + Next.js + MySQL çš„ç‰©æµé…é€ç®¡ç†ç³»ç»Ÿï¼ŒåŒ…å«åç«¯APIæœåŠ¡å’Œç®¡ç†åå°ä¸¤ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œé€šè¿‡å°ç¨‹åºAPIæ¥å£ä¸ºç§»åŠ¨ç«¯æä¾›æœåŠ¡ã€‚

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### ç¯å¢ƒè¦æ±‚

- **Node.js**: >= 18.18.0 (æ¨èä½¿ç”¨ v20.x)
- **MySQL**: >= 5.7 æˆ– 8.0+
- **npm**: >= 8.0.0

### æœåŠ¡ç®¡ç†

ä½¿ç”¨ `ser.sh` è„šæœ¬ç®¡ç†æ‰€æœ‰æœåŠ¡ï¼š

```bash
# åŸºæœ¬ç”¨æ³•
./ser.sh                    # æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
./ser.sh status            # æŸ¥çœ‹æœåŠ¡çŠ¶æ€

# å¯åŠ¨æœåŠ¡
./ser.sh start all         # å¯åŠ¨æ‰€æœ‰æœåŠ¡
./ser.sh start backend     # åªå¯åŠ¨åç«¯
./ser.sh start admin       # åªå¯åŠ¨ç®¡ç†åå°

# åœæ­¢æœåŠ¡
./ser.sh stop all          # åœæ­¢æ‰€æœ‰æœåŠ¡
./ser.sh stop backend      # åªåœæ­¢åç«¯
./ser.sh stop admin        # åªåœæ­¢ç®¡ç†åå°

# é‡å¯æœåŠ¡
./ser.sh restart all       # é‡å¯æ‰€æœ‰æœåŠ¡
./ser.sh restart backend   # åªé‡å¯åç«¯
./ser.sh restart admin     # åªé‡å¯ç®¡ç†åå°
```

### å…¼å®¹æ€§è„šæœ¬

```bash
./start-dev.sh      # å¯åŠ¨å¼€å‘ç¯å¢ƒ (ç­‰åŒäº ./ser.sh start all)
./stop-dev.sh       # åœæ­¢å¼€å‘ç¯å¢ƒ (ç­‰åŒäº ./ser.sh stop all)
./start-prod.sh     # å¯åŠ¨ç”Ÿäº§ç¯å¢ƒ
./stop-prod.sh      # åœæ­¢ç”Ÿäº§ç¯å¢ƒ
```

## ğŸ“± è®¿é—®åœ°å€

å¯åŠ¨æˆåŠŸåå¯ä»¥è®¿é—®ï¼š

| æœåŠ¡ | åœ°å€ | è¯´æ˜ |
|------|------|------|
| **åç«¯API** | http://localhost:3000 | åç«¯æœåŠ¡ä¸»åœ°å€ |
| **APIæ–‡æ¡£** | http://localhost:3000/api | Swagger APIæ–‡æ¡£ |
| **ç®¡ç†åå°** | http://localhost:3001 | ç®¡ç†å‘˜æ“ä½œç•Œé¢ |
| **å°ç¨‹åºæµ‹è¯•** | ./miniprogram-test.html | å°ç¨‹åºæ¥å£æµ‹è¯•é¡µé¢ |

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ•´ä½“æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç§»åŠ¨ç«¯åº”ç”¨     â”‚    â”‚   ç®¡ç†åå°       â”‚    â”‚   åç«¯API       â”‚
â”‚ (å°ç¨‹åºAPIæ¥å£)  â”‚    â”‚  (Next.js 15)   â”‚    â”‚   (NestJS 10)   â”‚
â”‚   ç­¾åæ ¡éªŒè®¤è¯   â”‚    â”‚   ç«¯å£: 3001     â”‚    â”‚   ç«¯å£: 3000     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   MySQL 8.0     â”‚
                    â”‚   (æ•°æ®å­˜å‚¨)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆ

#### åç«¯æœåŠ¡ (backend-node)
- **æ¡†æ¶**: NestJS 10.x + TypeScript 5.x
- **æ•°æ®åº“**: MySQL 8.0 + TypeORM 0.3.x
- **è®¤è¯**: JWT + bcrypt + CASLæƒé™æ§åˆ¶
- **APIæ–‡æ¡£**: Swagger/OpenAPI 3.0
- **æ–‡ä»¶ä¸Šä¼ **: Multer + æœ¬åœ°å­˜å‚¨

#### ç®¡ç†åå° (admin-frontend)
- **æ¡†æ¶**: Next.js 15.3.4 + Turbopack
- **UIåº“**: Arco Design + TailwindCSS 3.x
- **çŠ¶æ€ç®¡ç†**: React Hooks + Axios
- **è¡¨å•**: React Hook Form

#### ç§»åŠ¨ç«¯æ¥å£
- **å°ç¨‹åºAPI**: ä¸“é—¨çš„ç§»åŠ¨ç«¯æ¥å£æ¨¡å—
- **ç­¾åæ ¡éªŒ**: HMAC-SHA256å®‰å…¨è®¤è¯
- **åŠŸèƒ½æ”¯æŒ**: å®¢æˆ·æœç´¢ã€ç­¾æ”¶å•ä¸Šä¼ ã€åœ°ç†ä½ç½®ç­‰

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
dswl1/
â”œâ”€â”€ backend-node/           # NestJS åç«¯æœåŠ¡ (ç«¯å£ 3000)
â”œâ”€â”€ admin-frontend/         # Next.js ç®¡ç†åå° (ç«¯å£ 3001)
â”œâ”€â”€ docs/                  # ğŸ“š å®Œæ•´çš„ç³»ç»Ÿæ–‡æ¡£
â”œâ”€â”€ ser.sh                # æœåŠ¡ç®¡ç†è„šæœ¬ (ä¸»è„šæœ¬)
â”œâ”€â”€ sync.sh               # æ•°æ®åŒæ­¥è„šæœ¬
â”œâ”€â”€ init.sql              # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ logs/                 # è¿è¡Œæ—¥å¿—ç›®å½•
â”œâ”€â”€ pids/                 # è¿›ç¨‹IDç®¡ç†ç›®å½•
â”œâ”€â”€ index.html            # ç³»ç»Ÿé¦–é¡µ
â””â”€â”€ miniprogram-test.html # å°ç¨‹åºæ¥å£æµ‹è¯•é¡µé¢
```

## ğŸ” é»˜è®¤è´¦å·

### ç®¡ç†åå°ç™»å½•
- **ç”¨æˆ·å**: `admin`
- **å¯†ç **: `admin2025`

### æµ‹è¯•å°ç¨‹åºç”¨æˆ·
- å¼ ä¸‰ï¼ˆå¸æœºï¼‰ï¼š13800000001
- æå››ï¼ˆå¸æœºï¼‰ï¼š13800000002
- ç‹äº”ï¼ˆå¸æœºï¼‰ï¼š13800000003

## ğŸ“‹ æ•°æ®åº“é…ç½®

```javascript
// é»˜è®¤é…ç½® (backend-node/src/config/database.config.ts)
{
  host: 'localhost',
  port: 3306,
  username: 'root',
  password: '123456',
  database: 'delivery_system'
}
```

### å¿«é€Ÿåˆå§‹åŒ–æ•°æ®åº“
mysql -u root -p123456 < init.sql
```



## ğŸ“ æ”¯æŒä¸æ–‡æ¡£

### è¿è¡Œæ—¥å¿—
- åç«¯æ—¥å¿—: `logs/backend.log`
- ç®¡ç†åå°æ—¥å¿—: `logs/admin.log`

### è¯¦ç»†æ–‡æ¡£
- [ğŸ“š å®Œæ•´æ–‡æ¡£ç›®å½•](./docs/) - ç³»ç»Ÿå®Œæ•´çš„æŠ€æœ¯æ–‡æ¡£å’Œä½¿ç”¨æŒ‡å—

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### ç®¡ç†åå°åŠŸèƒ½
- âœ… **å®¢æˆ·åœ°å€ç®¡ç†**: å®¢æˆ·ä¿¡æ¯CRUDã€æœç´¢ç­›é€‰ã€æ‰¹é‡æ“ä½œã€æ•°æ®åŒæ­¥
- âœ… **ç”¨æˆ·ç®¡ç†**: ç³»ç»Ÿç”¨æˆ·è´¦å·ç®¡ç†ã€å¯†ç é‡ç½®
- âœ… **è§’è‰²æƒé™**: åŸºäºRBACçš„ç»†ç²’åº¦æƒé™æ§åˆ¶
- âœ… **å°ç¨‹åºç”¨æˆ·**: å¸æœºå’Œé”€å”®äººå‘˜ä¿¡æ¯ç®¡ç†
- âœ… **ç­¾æ”¶å•ç®¡ç†**: ç­¾æ”¶å•æŸ¥çœ‹ã€å›¾ç‰‡é¢„è§ˆã€æ•°æ®æ¸…ç†

### å°ç¨‹åºAPIåŠŸèƒ½
- âœ… **èº«ä»½è®¤è¯**: å¾®ä¿¡ç™»å½•ã€æ‰‹æœºå·éªŒè¯ã€MACåœ°å€ç»‘å®š
- âœ… **å®¢æˆ·æœç´¢**: æ”¯æŒç¼–å·/å§“å/åœ°å€æ¨¡ç³Šæœç´¢ï¼Œç­¾åæ ¡éªŒ
- âœ… **ç­¾æ”¶å•ä¸Šä¼ **: æ‹ç…§ä¸Šä¼ ã€åœ°ç†ä½ç½®è®°å½•ã€å®æ—¶å¤„ç†
- âœ… **å®¢æˆ·ç®¡ç†**: é”€å”®äººå‘˜æ–°å¢å®¢æˆ·ã€åœ°å€æ›´æ–°åŠŸèƒ½
- âœ… **å®‰å…¨æœºåˆ¶**: HMAC-SHA256ç­¾åæ ¡éªŒã€Tokenè®¤è¯

---

**ğŸš€ å¿«é€Ÿå¼€å§‹**: è¿è¡Œ `./ser.sh start all` å³å¯å¯åŠ¨æ•´ä¸ªç³»ç»Ÿï¼

## ğŸ“± å°ç¨‹åºæ¥å£æµ‹è¯•

ç³»ç»Ÿæä¾›äº†ä¸“é—¨çš„å°ç¨‹åºæ¥å£æµ‹è¯•é¡µé¢ï¼Œæ”¯æŒï¼š
- ğŸ” **ç­¾åæ ¡éªŒæµ‹è¯•**: è‡ªåŠ¨ç”ŸæˆHMAC-SHA256ç­¾å
- ğŸ‘¤ **ç”¨æˆ·ç™»å½•æµ‹è¯•**: å¾®ä¿¡ç”¨æˆ·ç™»å½•å’ŒTokenè·å–
- ğŸ” **å®¢æˆ·æœç´¢æµ‹è¯•**: å®¢æˆ·ä¿¡æ¯æŸ¥è¯¢åŠŸèƒ½
- ğŸ“‹ **ç­¾æ”¶å•ä¸Šä¼ æµ‹è¯•**: æ–‡ä»¶ä¸Šä¼ å’Œæ•°æ®æäº¤
- ğŸ› ï¸ **å¼€å‘è°ƒè¯•å·¥å…·**: å¯†é’¥è·å–å’Œå‚æ•°éªŒè¯

**è®¿é—®æ–¹å¼**: åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `miniprogram-test.html` æ–‡ä»¶å³å¯ä½¿ç”¨ã€‚