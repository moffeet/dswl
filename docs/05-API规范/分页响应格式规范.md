# ğŸ“„ åˆ†é¡µå“åº”æ ¼å¼è§„èŒƒ

## ğŸ“‹ æ¦‚è¿°

ä¸ºäº†ç¡®ä¿å‰ç«¯å¤„ç†çš„ä¸€è‡´æ€§ï¼Œæ‰€æœ‰åˆ†é¡µæŸ¥è¯¢æ¥å£éƒ½å¿…é¡»ä½¿ç”¨ç»Ÿä¸€çš„å“åº”æ ¼å¼ã€‚

## âœ… æ ‡å‡†åˆ†é¡µå“åº”æ ¼å¼

### å“åº”ç»“æ„
```json
{
  "code": 200,
  "message": "è·å–æˆåŠŸ",
  "data": {
    "list": [...],           // æ•°æ®åˆ—è¡¨
    "total": 100,           // æ€»è®°å½•æ•°
    "page": 1,              // å½“å‰é¡µç 
    "limit": 10,            // æ¯é¡µæ•°é‡
    "totalPages": 10        // æ€»é¡µæ•°
  },
  "timestamp": "2025-01-10T10:00:00.000Z"
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `code` | number | å“åº”çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ |
| `message` | string | å“åº”æ¶ˆæ¯ |
| `data` | object | æ•°æ®å¯¹è±¡ |
| `data.list` | array | å®é™…æ•°æ®åˆ—è¡¨ |
| `data.total` | number | æ€»è®°å½•æ•° |
| `data.page` | number | å½“å‰é¡µç ï¼ˆä»1å¼€å§‹ï¼‰ |
| `data.limit` | number | æ¯é¡µæ•°é‡ |
| `data.totalPages` | number | æ€»é¡µæ•° |
| `timestamp` | string | å“åº”æ—¶é—´æˆ³ |

## ğŸ”§ åç«¯å®ç°

### ä½¿ç”¨ ResponseUtil.page() æ–¹æ³•

```typescript
import { ResponseUtil } from '../common/utils/response.util';

// åœ¨æ§åˆ¶å™¨ä¸­ä½¿ç”¨
async findAll(@Query() queryDto: QueryDto) {
  const { data, total } = await this.service.findAll(queryDto);
  
  // âœ… æ­£ç¡®çš„æ–¹å¼
  return ResponseUtil.page(
    data,                    // æ•°æ®åˆ—è¡¨
    total,                   // æ€»è®°å½•æ•°
    queryDto.page || 1,      // å½“å‰é¡µç 
    queryDto.limit || 10,    // æ¯é¡µæ•°é‡
    'è·å–æˆåŠŸ'               // æ¶ˆæ¯
  );
}
```

### æ‰‹åŠ¨æ„é€ å“åº”ï¼ˆä¸æ¨èï¼‰

```typescript
// âœ… æ­£ç¡®æ ¼å¼
return {
  code: 200,
  message: 'è·å–æˆåŠŸ',
  data: {
    list: data,
    total,
    page,
    limit,
    totalPages: Math.ceil(total / limit)
  }
};

// âŒ é”™è¯¯æ ¼å¼ï¼ˆåˆ†é¡µä¿¡æ¯åœ¨å¤–å±‚ï¼‰
return {
  code: 200,
  message: 'è·å–æˆåŠŸ',
  data: data,        // æ•°æ®ç›´æ¥åœ¨dataä¸­
  total,             // åˆ†é¡µä¿¡æ¯åœ¨å¤–å±‚
  page,
  limit,
  totalPages
};
```

## ğŸ¯ å‰ç«¯å¤„ç†

### JavaScript/TypeScript

```typescript
interface PaginationResponse<T> {
  code: number;
  message: string;
  data: {
    list: T[];
    total: number;
    page: number;
    limit: number;
    totalPages: number;
  };
  timestamp: string;
}

// å¤„ç†å“åº”
const response = await fetch('/api/customers');
const result: PaginationResponse<Customer> = await response.json();

if (result.code === 200) {
  const { list, total, page, limit, totalPages } = result.data;
  
  // è®¾ç½®æ•°æ®
  setData(list);
  setTotal(total);
  setPagination({ page, limit, total, totalPages });
}
```

### React ç¤ºä¾‹

```tsx
const [data, setData] = useState([]);
const [pagination, setPagination] = useState({
  page: 1,
  limit: 10,
  total: 0,
  totalPages: 0
});

const fetchData = async () => {
  const response = await fetch(`/api/customers?page=${pagination.page}&limit=${pagination.limit}`);
  const result = await response.json();
  
  if (result.code === 200) {
    setData(result.data.list);
    setPagination({
      page: result.data.page,
      limit: result.data.limit,
      total: result.data.total,
      totalPages: result.data.totalPages
    });
  }
};
```

## ğŸ“ API æ–‡æ¡£è§„èŒƒ

### Swagger æ–‡æ¡£ç¤ºä¾‹

```typescript
@ApiResponse({
  status: 200,
  description: 'è·å–æˆåŠŸ',
  schema: {
    type: 'object',
    properties: {
      code: { type: 'number', example: 200 },
      message: { type: 'string', example: 'è·å–æˆåŠŸ' },
      data: {
        type: 'object',
        properties: {
          list: {
            type: 'array',
            items: { $ref: '#/components/schemas/Customer' }
          },
          total: { type: 'number', example: 100 },
          page: { type: 'number', example: 1 },
          limit: { type: 'number', example: 10 },
          totalPages: { type: 'number', example: 10 }
        }
      },
      timestamp: { type: 'string', example: '2025-01-10T10:00:00.000Z' }
    }
  }
})
```

## ğŸš¨ å¸¸è§é”™è¯¯

### âŒ é”™è¯¯ç¤ºä¾‹1ï¼šåˆ†é¡µä¿¡æ¯åœ¨å¤–å±‚
```json
{
  "code": 200,
  "message": "è·å–æˆåŠŸ",
  "data": [...],      // æ•°æ®ç›´æ¥æ˜¯æ•°ç»„
  "total": 100,       // åˆ†é¡µä¿¡æ¯åœ¨å¤–å±‚
  "page": 1,
  "limit": 10
}
```

### âŒ é”™è¯¯ç¤ºä¾‹2ï¼šç¼ºå°‘åˆ†é¡µä¿¡æ¯
```json
{
  "code": 200,
  "message": "è·å–æˆåŠŸ",
  "data": {
    "list": [...],
    "total": 100      // ç¼ºå°‘ pageã€limitã€totalPages
  }
}
```

### âŒ é”™è¯¯ç¤ºä¾‹3ï¼šå­—æ®µåä¸ç»Ÿä¸€
```json
{
  "code": 200,
  "message": "è·å–æˆåŠŸ",
  "data": {
    "items": [...],   // åº”è¯¥æ˜¯ list
    "count": 100,     // åº”è¯¥æ˜¯ total
    "pageNum": 1,     // åº”è¯¥æ˜¯ page
    "pageSize": 10    // åº”è¯¥æ˜¯ limit
  }
}
```

## ğŸ” æ£€æŸ¥æ¸…å•

åœ¨å®ç°åˆ†é¡µæ¥å£æ—¶ï¼Œè¯·ç¡®ä¿ï¼š

- [ ] ä½¿ç”¨ `ResponseUtil.page()` æ–¹æ³•æˆ–æ‰‹åŠ¨æ„é€ æ ‡å‡†æ ¼å¼
- [ ] åˆ†é¡µä¿¡æ¯åœ¨ `data` å¯¹è±¡å†…éƒ¨ï¼Œä¸åœ¨å¤–å±‚
- [ ] åŒ…å«æ‰€æœ‰å¿…éœ€å­—æ®µï¼š`list`ã€`total`ã€`page`ã€`limit`ã€`totalPages`
- [ ] å­—æ®µåç§°ä¸è§„èŒƒä¸€è‡´
- [ ] API æ–‡æ¡£æè¿°äº†æ­£ç¡®çš„å“åº”æ ¼å¼
- [ ] å‰ç«¯ä»£ç æŒ‰ç…§æ ‡å‡†æ ¼å¼å¤„ç†å“åº”

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [APIå“åº”æ ¼å¼è§„èŒƒ](./APIå“åº”æ ¼å¼è§„èŒƒ.md)
- [é”™è¯¯å¤„ç†è§„èŒƒ](./é”™è¯¯å¤„ç†è§„èŒƒ.md)
- [å‰ç«¯æ¥å£è°ƒç”¨è§„èŒƒ](./å‰ç«¯æ¥å£è°ƒç”¨è§„èŒƒ.md)

---

**æ³¨æ„**: å¦‚æœå‘ç°ä»»ä½•æ¥å£ä¸ç¬¦åˆæ­¤è§„èŒƒï¼Œè¯·åŠæ—¶ä¿®æ”¹ä»¥ç¡®ä¿ç³»ç»Ÿçš„ä¸€è‡´æ€§ã€‚
