# æ–‡ä»¶å­˜å‚¨é…ç½®è¯´æ˜

## ğŸ“ å­˜å‚¨è·¯å¾„é…ç½®

æœ¬ç³»ç»Ÿæ”¯æŒè·¨å¹³å°éƒ¨ç½²ï¼Œæ–‡ä»¶å­˜å‚¨è·¯å¾„å¯é€šè¿‡ç¯å¢ƒå˜é‡çµæ´»é…ç½®ã€‚

### ğŸ”§ é»˜è®¤è·¯å¾„è§„åˆ™

ç³»ç»Ÿä¼šè‡ªåŠ¨æ ¹æ®æ“ä½œç³»ç»Ÿé€‰æ‹©åˆé€‚çš„é»˜è®¤è·¯å¾„ï¼š

#### Windows ç³»ç»Ÿ
```
C:\receipts\uploads\
```
- ä½¿ç”¨é¡¹ç›®æ‰€åœ¨ç›˜ç¬¦çš„æ ¹ç›®å½•
- å¦‚æœé¡¹ç›®åœ¨ D ç›˜ï¼Œåˆ™ä¸º `D:\receipts\uploads\`

#### Linux/macOS ç³»ç»Ÿ
```
/receipts/uploads/
```
- ä½¿ç”¨ç³»ç»Ÿæ ¹ç›®å½•

### ğŸ›ï¸ è‡ªå®šä¹‰é…ç½®

å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ `UPLOAD_ROOT_PATH` è‡ªå®šä¹‰å­˜å‚¨è·¯å¾„ï¼š

#### åœ¨ .env æ–‡ä»¶ä¸­é…ç½®
```env
# Windows ç¤ºä¾‹
UPLOAD_ROOT_PATH=D:\custom\path\receipts\uploads

# Linux ç¤ºä¾‹
UPLOAD_ROOT_PATH=/var/uploads/receipts

# macOS ç¤ºä¾‹
UPLOAD_ROOT_PATH=/Users/shared/receipts/uploads
```

## ğŸ“‚ ç›®å½•ç»“æ„

æ–‡ä»¶æŒ‰ç…§å¹´/æœˆ/æ—¥åˆ†å±‚å­˜å‚¨ï¼š

```
receipts/uploads/
â”œâ”€â”€ receipts/
â”‚   â”œâ”€â”€ 2025/
â”‚   â”‚   â”œâ”€â”€ 01/
â”‚   â”‚   â”‚   â”œâ”€â”€ 09/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ receipt_1704758400000_abc123.jpg
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ receipt_1704758500000_def456.png
â”‚   â”‚   â”‚   â””â”€â”€ 10/
â”‚   â”‚   â””â”€â”€ 02/
â”‚   â””â”€â”€ 2024/
â””â”€â”€ other_files/
```

## ğŸŒ è®¿é—®URL

æ‰€æœ‰æ–‡ä»¶é€šè¿‡ç»Ÿä¸€çš„URLè·¯å¾„è®¿é—®ï¼š
```
http://localhost:3000/receipts/uploads/receipts/2025/01/09/receipt_xxx.jpg
```

## ğŸš€ éƒ¨ç½²é…ç½®

### Windows éƒ¨ç½²

1. **åˆ›å»ºç›®å½•**ï¼ˆä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œï¼‰ï¼š
```cmd
mkdir C:\receipts\uploads
```

2. **è®¾ç½®æƒé™**ï¼š
ç¡®ä¿åº”ç”¨ç¨‹åºæœ‰è¯»å†™æƒé™

3. **ç¯å¢ƒå˜é‡**ï¼ˆå¯é€‰ï¼‰ï¼š
```env
UPLOAD_ROOT_PATH=C:\receipts\uploads
```

### Linux éƒ¨ç½²

1. **åˆ›å»ºç›®å½•**ï¼š
```bash
sudo mkdir -p /receipts/uploads
sudo chown -R www-data:www-data /receipts/uploads
sudo chmod -R 755 /receipts/uploads
```

2. **ç¯å¢ƒå˜é‡**ï¼ˆå¯é€‰ï¼‰ï¼š
```env
UPLOAD_ROOT_PATH=/receipts/uploads
```

### macOS éƒ¨ç½²

1. **åˆ›å»ºç›®å½•**ï¼š
```bash
sudo mkdir -p /receipts/uploads
sudo chown -R $(whoami):staff /receipts/uploads
sudo chmod -R 755 /receipts/uploads
```

2. **ç¯å¢ƒå˜é‡**ï¼ˆå¯é€‰ï¼‰ï¼š
```env
UPLOAD_ROOT_PATH=/receipts/uploads
```

### Docker éƒ¨ç½²

åœ¨ docker-compose.yml ä¸­é…ç½®å·æ˜ å°„ï¼š

```yaml
version: '3.8'
services:
  backend:
    image: logistics-backend
    volumes:
      - /host/path/receipts/uploads:/receipts/uploads
    environment:
      - UPLOAD_ROOT_PATH=/receipts/uploads
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### æƒé™è¦æ±‚
- åº”ç”¨ç¨‹åºéœ€è¦å¯¹å­˜å‚¨ç›®å½•æœ‰è¯»å†™æƒé™
- Linux/macOS ç³»ç»Ÿå¯èƒ½éœ€è¦ sudo æƒé™åˆ›å»ºæ ¹ç›®å½•

### ç£ç›˜ç©ºé—´
- å®šæœŸç›‘æ§ç£ç›˜ä½¿ç”¨æƒ…å†µ
- å»ºè®®è®¾ç½®ç£ç›˜ç©ºé—´å‘Šè­¦

### å¤‡ä»½ç­–ç•¥
- å®šæœŸå¤‡ä»½ uploads ç›®å½•
- è€ƒè™‘ä½¿ç”¨ç½‘ç»œå­˜å‚¨æˆ–äº‘å­˜å‚¨

### å®‰å…¨è€ƒè™‘
- é™åˆ¶æ–‡ä»¶ç±»å‹å’Œå¤§å°
- å®šæœŸæ¸…ç†è¿‡æœŸæ–‡ä»¶
- é˜²æ­¢ç›®å½•éå†æ”»å‡»

## ğŸ” æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

1. **æƒé™ä¸è¶³**
```
Error: EACCES: permission denied, mkdir '/receipts/uploads'
```
è§£å†³ï¼šæ£€æŸ¥ç›®å½•æƒé™ï¼Œä½¿ç”¨ sudo åˆ›å»ºç›®å½•

2. **ç£ç›˜ç©ºé—´ä¸è¶³**
```
Error: ENOSPC: no space left on device
```
è§£å†³ï¼šæ¸…ç†ç£ç›˜ç©ºé—´æˆ–æ‰©å®¹

3. **è·¯å¾„ä¸å­˜åœ¨**
```
Error: ENOENT: no such file or directory
```
è§£å†³ï¼šæ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®ï¼Œç¡®ä¿è·¯å¾„å­˜åœ¨

### è°ƒè¯•å‘½ä»¤

æ£€æŸ¥å½“å‰é…ç½®ï¼š
```bash
# æŸ¥çœ‹ç¯å¢ƒå˜é‡
echo $UPLOAD_ROOT_PATH

# æ£€æŸ¥ç›®å½•æƒé™
ls -la /receipts/uploads

# æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h /receipts/uploads
```

## ğŸ“Š ç›‘æ§å»ºè®®

### ç£ç›˜ä½¿ç”¨ç›‘æ§
```bash
# æ£€æŸ¥ç›®å½•å¤§å°
du -sh /receipts/uploads

# ç›‘æ§ç£ç›˜ä½¿ç”¨ç‡
df -h | grep receipts
```

### æ–‡ä»¶æ•°é‡ç»Ÿè®¡
```bash
# ç»Ÿè®¡æ–‡ä»¶æ€»æ•°
find /receipts/uploads -type f | wc -l

# æŒ‰æ—¥æœŸç»Ÿè®¡
find /receipts/uploads -type f -newermt "2025-01-01" | wc -l
```
